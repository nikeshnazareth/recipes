Recipe:
  required:
    - title
    - prepTime
    - cookTime
    - ingredientSections
  properties:
    id:
      $ref: '#/definitions/ID'
    title:
      $ref: '#/definitions/NonEmptyString'
    serves:
      $ref: '#/definitions/Quantity'
    makes:
      $ref: '#/definitions/Quantity'
    prep_time:
      $ref: '#/definitions/Duration'
    cook_time:
      $ref: '#/definitions/Duration'
    ingredient_sections:
      type: array
      items:
        $ref: '#/definitions/IngredientSection'
    method:
      type: array
      items:
        $ref: '#/definitions/NonEmptyString'
    reference_url:
      $ref: '#/definitions/NonEmptyString'
    image_url:
      $ref: '#/definitions/NonEmptyString'
    last_updated:
      $ref: '#/definitions/Timestamp'

IngredientSection:
  required:
    - ingredients
  properties:
    heading:
      $ref: '#/definitions/NonEmptyString'
    ingredients:
      type: array
      items:
        required:
          - ingredient_type
        properties:
          ingredient_type:
            type: number
            minimum: 0
            maximum: 1
        discriminator:
          propertyName: ingredient_type

Quantified:
  required:
    - ingredient_type
    - amount
    - unit_id
    - food_id
  properties:
    ingredient_type:
      type: number
      minimum: 0
      maximum: 0
    amount:
      $ref: '#/definitions/Quantity'
    unit_ids:
      $ref: '#/definitions/UnitIDs'
    food_id:
      $ref: '#/definitions/ID'
    additional_desc:
      $ref: '#/definitions/NonEmptyString'

FreeText:
  required:
    - ingredient_type
    - description
  properties:
    ingredient_type:
      type: number
      minimum: 1
      maximum: 1
    description:
      $ref: '#/definitions/NonEmptyString'

Food:
  required:
    - name
    - conversions
  properties:
    id:
      $ref: '#/definitions/ID'
    name:
      $ref: '#/definitions/Name'
    conversions:
      type: array
      items:
        type: object
        required:
          - unit
          - ratio
        properties:
          unit_id:
            $ref: '#/definitions/UnitID'
          ratio:
            type: number
            minimum: 0
            exclusiveMinimum: true

ID:
  type: string
  example: '< Set by the server >'

NonEmptyString:
  type: string
  minLength: 1

Name:
  properties:
    singular:
      type: string
      minLength: 1
    plural:
      type: string
      minLength: 1

Quantity:
  type: number
  minimum: 0
  exclusiveMinimum: true

# In mins
Duration:
  type: number
  minimum: 0
  exclusiveMinimum: true

# The app uses a hardcoded enum to describe units
UnitID:
  type: array
  items:
    type: integer
    minimum: 0
    maximum: 12

Timestamp:
  type: integer
  example: '< Set by the server >'